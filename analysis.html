<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CP Lipid Droplet AI – Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Top navigation / brand -->
  <header class="cp-header">
    <div class="cp-header-inner">
      <div class="brand-area">
        <div class="brand-logo-circle">CP</div>
        <div>
          <div class="brand-text-main">Lipid Droplet AI</div>
          <div class="brand-text-sub">
            Hepatopancreas Wet Mount Assistant
          </div>
        </div>
      </div>

      <nav class="nav-actions">
        <a href="index.html" class="nav-btn">
          <span class="dot"></span>
          Training
        </a>
        <a href="analysis.html" class="nav-btn nav-btn-active">
          <span class="dot"></span>
          Analysis
        </a>
      </nav>
    </div>
  </header>

  <main class="page-shell">
    <section class="page-header">
      <div class="page-kicker">Model Inference</div>
      <h1 class="page-title">Lipid Droplet Analysis Interface</h1>
      <p class="page-subtitle">
        Use the trained model (either from this browser or from an imported
        JSON database) to analyse multiple hepatopancreas wet mount images in
        one batch and estimate the lipid droplet percentage for each image.
      </p>
    </section>

    <section class="section-card">
      <h2 class="section-title">Batch Image Analysis</h2>
      <p class="section-caption">
        Select one or more images, then run the analysis. Results will list the
        file name and the predicted lipid droplet percentage. Make sure the
        model has been trained or a database has been imported on the Training
        page before using this tool.
      </p>

      <div class="field-group">
        <div class="field-label">Select images to analyse</div>
        <label class="file-btn">
          <span class="file-btn-icon">+</span>
          <span>Choose image files</span>
          <input
            type="file"
            id="analysisImagesInput"
            accept="image/*"
            multiple
          />
        </label>
        <span class="file-chosen" id="analysisFilesLabel">
          No files selected
        </span>
      </div>

      <button id="runAnalysisButton" class="btn btn-primary">
        Run analysis
      </button>

      <p class="section-status" id="analysisStatus">
        Model not trained yet. Please perform training or load a database on
        the Training page.
      </p>

      <!-- Results table (use ids that your JS already expects) -->
      <table class="results-table" id="analysisResultsTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Filename</th>
            <th>Predicted lipid droplet (%)</th>
          </tr>
        </thead>
        <tbody id="analysisResultsBody">
          <!-- rows will be injected by app.js -->
        </tbody>
      </table>
    </section>
  </main>

  <footer class="cp-footer">
    © 2025 CP Prima – Experimental Tool for Shrimp Hepatopancreas Lipid
    Assessment
  </footer>

  <!-- Scripts (unchanged tools) -->
  <script src="model.js"></script>
  <script src="storage.js"></script>
  <script src="app.js"></script>
</body>
</html>
