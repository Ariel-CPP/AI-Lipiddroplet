<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CP Lipid Droplet AI – Training</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body data-page="training">
  <header class="cp-header">
    <div class="cp-header-inner">
      <div class="cp-logo">
        <span class="cp-logo-mark">CP</span>
        <span class="cp-logo-text">Lipid Droplet AI</span>
      </div>
      <nav class="cp-nav">
        <a href="index.html" class="cp-nav-link cp-nav-link-active">Training</a>
        <a href="analysis.html" class="cp-nav-link">Analysis</a>
      </nav>
    </div>
  </header>

  <main class="cp-main">
    <section class="cp-hero">
      <h1>Lipid Droplet Training Interface</h1>
      <p>
        Upload wet mount hepatopancreas images, assign known lipid droplet percentages,
        and iteratively train the browser-based model. The model and its database can
        be exported and shared with other users.
      </p>
    </section>

    <section class="cp-grid">
      <!-- Training card -->
      <article class="cp-card">
        <h2>1. Upload Training Images</h2>
        <p class="cp-muted">
          Select one or more images. For each image, provide the ground-truth lipid
          droplet percentage (0–100%) based on your histological assessment.
        </p>

        <div class="cp-form-group">
          <label for="training-files" class="cp-label">Select training images</label>
          <input
            id="training-files"
            type="file"
            accept="image/*"
            multiple
            class="cp-input-file"
          />
        </div>

        <div id="training-preview-container" class="preview-list">
          <!-- Per-image rows (thumbnail + filename + % input) will be injected here -->
        </div>

        <button id="train-button" class="cp-button primary" disabled>
          Train model on selected images
        </button>

        <div class="cp-status">
          <div><strong>Total trained images:</strong> <span id="total-trained">0</span></div>
          <div><strong>Model info:</strong> <span id="model-info">Not trained yet</span></div>
        </div>
      </article>

      <!-- Database card -->
      <article class="cp-card">
        <h2>2. Model Database</h2>
        <p class="cp-muted">
          The trained model and metadata are stored locally in your browser. You can export the
          database as a JSON file and share it via e-mail or any other channel. Other users can
          then import the same database to obtain an identical model.
        </p>

        <div class="cp-subcard">
          <h3>Download database</h3>
          <p class="cp-muted">
            Export the current neural network database as a JSON file.
          </p>
          <button id="download-db-button" class="cp-button secondary">
            Download JSON database
          </button>
        </div>

        <div class="cp-subcard">
          <h3>Upload database</h3>
          <p class="cp-muted">
            Import a JSON database file from another user to reuse the same trained model.
          </p>
          <div class="cp-form-group-inline">
            <input
              id="upload-db-input"
              type="file"
              accept="application/json"
              class="cp-input-file"
            />
            <button id="upload-db-button" class="cp-button secondary">
              Load database
            </button>
          </div>
          <p id="upload-db-status" class="cp-small-status"></p>
        </div>
      </article>
    </section>
  </main>

  <footer class="cp-footer">
    © 2025 CP Prima – Experimental Tool for Shrimp Hepatopancreas Lipid Assessment
  </footer>

  <script src="model.js"></script>
  <script src="storage.js"></script>
  <script src="app.js"></script>
</body>
</html>
